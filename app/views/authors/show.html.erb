<h2>Author: <%= @author.name %></h2>

<% if admin_user? %>
  <%= link_to "Edit Author", edit_author_path(@author), class: "meh-btn right"  %>
  <%= link_to "Delete", author_path(@author), method: :delete, data: {confirm: "Are you sure you want to delete this author?"}, class: "danger-btn right" %>
<% end %>

<table class="index tablesorter">
  <thead>
    <tr>
      <th>Title</th>
      <th>Category</th>
      <th>Available</th>
    </tr>
  </thead>

  <tbody>
    <% @books.each do |b| %>
      <% on_loan = "on-loan" if !b.available %>
      <% in_storage = "in-storage" if b.in_storage %>
      <tr class="<%= on_loan %>">
        <td>
          <% if librarian_user? %>
            <%=  check_box_tag :selected, b.id, b.selected, id: "book-select_#{b.id}"  %>
          <% end %>
          <%= link_to b.title, book_path(b.id) %>
        </td>
        <td>
          <% if b.genre %>
            <%= link_to b.genre.name, genre_path(b.genre) %>
          <% end %>
        </td>
        <td>
          <span class="<%= on_loan %>"></span>
          <span class="<%= in_storage %>"></span>
          <!-- icon shows up here if book is on loan/in storage -->
        </td>
        <td>
          <% if librarian_user? %>
            <%= link_to "edit", edit_book_path(b) %>
            <% if admin_user? %>
              <%= link_to "delete", book_path(b), method: :delete, data: {confirm: "Are you sure you want to delete this book?"} %>
            <% end %>
        <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>